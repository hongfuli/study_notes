#  基础架构：一条SQL查询流程

## 组件
1. 连接器
1. 分析器
1. 优化器
1. 执行器
1. 存储引擎

## 连接器
连接长期保持会占用临时内存，只有断开连接才会释放连接，但是短连接的tcp连接及权限加载也会成本比较高。
折中办法是定时断开重连，或者执行 `mysql_reset_connection` (没有找到这个指令啊，难道是内部接口?)。

## 查询缓存
建议最好使用缓存，因为表上有任何更新都会导致整个和这表关联的缓存都会失效。MySQL8.0 版本后删除了整个缓存功能。

## 分析器
词法分析和语法分析阶段。

## 优化器
对 SQL 语句做优化分析，比如索引选择，表关联时连接顺序。

## 执行器
执行器和存储引擎提供的数据接口交互。比如查询，写入等。执行器每调用一次存储引擎，`rows_examined` 会累加一次，这个值可以在慢日志中看到。

