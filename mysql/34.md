# 到底可不可以使用join？

如果被驱动表有索引，join 的性能还可以。但是驱动表最好是能过滤少量数据。这样好处是：驱动表数据量很少（最好走索引），被驱动表也可以走索引。


## Simple Nested-Loop Join
如果被驱动表没有索引，则会每次从驱动表一行数据关联时，都会在被驱动表做一次全表扫描。这个性能最差。

## Block Nested-Loop Join
为了解决这个问题，可以一次性的把驱动表的数据加载到内存，然后只需要扫描一遍被驱动表，用每行数据对比驱动表内存数据。这样好处是：被驱动表只用扫描一次了。但是如果内存不够呢（`join_buffer_size`）？则需要分块（jblock）来加载驱动表了。
如果驱动表数据容量是 N，buffer 大小是 K，则被驱动表需要扫描的次数就变成了 N/K * M。其中 M 是被驱动数据容量。所以从这个公式看出，如果要减少有磁盘扫描次数，可以增加 buffer 值。

反正终极原则还是小表驱动大表，大表能索引。
