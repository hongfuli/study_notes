# 如何判断一个数据库是不是出问题了？

本文主要讲数据异常监控方法。

## select 1 判断
因为 select 1 很轻量，所以有时候发现不了问题。就像大家做业务开发监控 api 是否正常，如果只是写个 echo 接口，其实很多问题发现不了的。

这里提到了 `innodb_thread_concurrency` 这个参数，限制的不是客户端 socket 连接并发，而是真正消耗 CPU 操作的线程。要注意的，这里也不限制**等待锁**的操作，即如果一条 sql 因为等待锁而阻塞了，也是会释放这个并发统计的。


## update 判断
在某个库里写个 `health_checker` 表，使用 update 语句检测。主备库都需要这个检测的话，为了防止冲突导致 replication 中止，可以用 `server_id` 来做主键，不同实例更新不同的行。

## 利用 MySQL 内部性能检测机制
`performance_schema` 库里面有一些监控性能指标的表。


